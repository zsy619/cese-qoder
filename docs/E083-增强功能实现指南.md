# API Provider å¢å¼ºåŠŸèƒ½å®ç°æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›API ProvideråŠŸèƒ½çš„å¢å¼ºå®ç°æŒ‡å—ï¼ŒåŒ…æ‹¬æœç´¢è¿‡æ»¤ã€æ‰¹é‡æ“ä½œã€æµ‹è¯•è¿æ¥ã€åŠ¨ç”»ä¼˜åŒ–ç­‰åŠŸèƒ½çš„è¯¦ç»†å®ç°æ–¹æ¡ˆã€‚

## ğŸ” 1. æœç´¢å’Œè¿‡æ»¤åŠŸèƒ½

### 1.1 éœ€æ±‚è¯´æ˜

- æŒ‰åç§°æœç´¢Provider
- æŒ‰çŠ¶æ€è¿‡æ»¤ï¼ˆå…¨éƒ¨/å¯ç”¨/ç¦ç”¨ï¼‰
- æŒ‰å¼€æ”¾ç±»å‹è¿‡æ»¤ï¼ˆå…¨éƒ¨/å…¬å¼€/ç§æœ‰ï¼‰
- å®æ—¶æœç´¢ï¼Œæ— éœ€ç‚¹å‡»æŒ‰é’®

### 1.2 å®ç°æ–¹æ¡ˆ

#### æ­¥éª¤1: æ·»åŠ çŠ¶æ€ç®¡ç†

åœ¨ `APIConfig.tsx` ä¸­æ·»åŠ æœç´¢å’Œè¿‡æ»¤çŠ¶æ€ï¼š

```typescript
// æœç´¢å’Œè¿‡æ»¤çŠ¶æ€
const [searchKeyword, setSearchKeyword] = useState('');
const [statusFilter, setStatusFilter] = useState<number | 'all'>('all');
const [openTypeFilter, setOpenTypeFilter] = useState<number | 'all'>('all');
```

#### æ­¥éª¤2: å®ç°è¿‡æ»¤é€»è¾‘

```typescript
/**
 * è¿‡æ»¤Provideråˆ—è¡¨
 */
const getFilteredProviders = (): APIProvider[] => {
  return providers.filter((provider) => {
    // å…³é”®è¯æœç´¢ï¼ˆåç§°ã€URLã€æ¨¡å‹ï¼‰
    const keyword = searchKeyword.toLowerCase();
    const matchesKeyword = !keyword || 
      provider.name.toLowerCase().includes(keyword) ||
      provider.api_url.toLowerCase().includes(keyword) ||
      provider.api_model.toLowerCase().includes(keyword) ||
      (provider.api_remark && provider.api_remark.toLowerCase().includes(keyword));

    // çŠ¶æ€è¿‡æ»¤
    const matchesStatus = statusFilter === 'all' || 
      provider.api_status === statusFilter;

    // å¼€æ”¾ç±»å‹è¿‡æ»¤
    const matchesOpenType = openTypeFilter === 'all' || 
      provider.api_open === openTypeFilter;

    return matchesKeyword && matchesStatus && matchesOpenType;
  });
};
```

#### æ­¥éª¤3: æ·»åŠ æœç´¢æ UI

åœ¨é¡µé¢å¤´éƒ¨å’Œè¡¨æ ¼ä¹‹é—´æ’å…¥ï¼š

```typescript
{/* æœç´¢å’Œè¿‡æ»¤æ  */}
<div className="search-filter-bar">
  <div className="search-box">
    <span className="search-icon">ğŸ”</span>
    <input
      type="text"
      placeholder="æœç´¢åç§°ã€URLæˆ–æ¨¡å‹..."
      value={searchKeyword}
      onChange={(e) => setSearchKeyword(e.target.value)}
      className="search-input"
    />
    {searchKeyword && (
      <button 
        className="clear-btn" 
        onClick={() => setSearchKeyword('')}
      >
        âœ•
      </button>
    )}
  </div>

  <div className="filter-controls">
    <select
      value={statusFilter}
      onChange={(e) => setStatusFilter(
        e.target.value === 'all' ? 'all' : parseInt(e.target.value)
      )}
      className="filter-select"
    >
      <option value="all">å…¨éƒ¨çŠ¶æ€</option>
      <option value="1">ä»…å¯ç”¨</option>
      <option value="0">ä»…ç¦ç”¨</option>
    </select>

    <select
      value={openTypeFilter}
      onChange={(e) => setOpenTypeFilter(
        e.target.value === 'all' ? 'all' : parseInt(e.target.value)
      )}
      className="filter-select"
    >
      <option value="all">å…¨éƒ¨ç±»å‹</option>
      <option value="1">ä»…å…¬å¼€</option>
      <option value="0">ä»…ç§æœ‰</option>
    </select>
  </div>
</div>
```

#### æ­¥éª¤4: æ›´æ–°æ¸²æŸ“é€»è¾‘

å°†è¡¨æ ¼æ¸²æŸ“ä¸­çš„ `providers` æ›¿æ¢ä¸º `getFilteredProviders()`:

```typescript
{getFilteredProviders().map((provider) => (
  <tr key={provider.id}>
    {/* ... è¡¨æ ¼å†…å®¹ ... */}
  </tr>
))}
```

#### æ­¥éª¤5: æ·»åŠ CSSæ ·å¼

åœ¨ `apiconfig.css` ä¸­æ·»åŠ ï¼š

```css
/* æœç´¢è¿‡æ»¤æ  */
.search-filter-bar {
  display: flex;
  gap: 1rem;
  align-items: center;
  background: white;
  padding: 1.5rem;
  border-radius: 12px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  margin-bottom: 1.5rem;
}

.search-box {
  flex: 1;
  display: flex;
  align-items: center;
  gap: 0.75rem;
  background: #f7fafc;
  padding: 0.75rem 1rem;
  border-radius: 8px;
  border: 2px solid transparent;
  transition: all 0.2s;
}

.search-box:focus-within {
  border-color: #667eea;
  background: white;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.search-icon {
  font-size: 1.2rem;
  color: #718096;
}

.search-input {
  flex: 1;
  border: none;
  background: transparent;
  font-size: 1rem;
  outline: none;
  color: #2d3748;
}

.search-input::placeholder {
  color: #a0aec0;
}

.clear-btn {
  padding: 0.25rem 0.5rem;
  background: transparent;
  border: none;
  color: #a0aec0;
  cursor: pointer;
  font-size: 1.2rem;
  transition: color 0.2s;
}

.clear-btn:hover {
  color: #718096;
}

.filter-controls {
  display: flex;
  gap: 0.75rem;
}

.filter-select {
  padding: 0.75rem 1rem;
  border: 2px solid #e2e8f0;
  border-radius: 8px;
  background: white;
  font-size: 0.95rem;
  color: #2d3748;
  cursor: pointer;
  transition: all 0.2s;
  outline: none;
}

.filter-select:hover {
  border-color: #cbd5e0;
}

.filter-select:focus {
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

/* å“åº”å¼ */
@media (max-width: 768px) {
  .search-filter-bar {
    flex-direction: column;
  }

  .search-box {
    width: 100%;
  }

  .filter-controls {
    width: 100%;
  }

  .filter-select {
    flex: 1;
  }
}
```

### 1.3 æ˜¾ç¤ºæœç´¢ç»“æœç»Ÿè®¡

```typescript
{/* æœç´¢ç»“æœæç¤º */}
{!loading && !error && (
  <div className="search-result-info">
    {searchKeyword || statusFilter !== 'all' || openTypeFilter !== 'all' ? (
      <p>
        æ‰¾åˆ° <strong>{getFilteredProviders().length}</strong> ä¸ªåŒ¹é…çš„Provider
        {searchKeyword && ` (å…³é”®è¯: "${searchKeyword}")`}
      </p>
    ) : (
      <p>å…± <strong>{providers.length}</strong> ä¸ªProvider</p>
    )}
  </div>
)}
```

CSSæ ·å¼ï¼š

```css
.search-result-info {
  padding: 0.75rem 1.5rem;
  background: #edf2f7;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-size: 0.9rem;
  color: #4a5568;
}

.search-result-info strong {
  color: #667eea;
  font-weight: 600;
}
```

---

## ğŸ“¦ 2. æ‰¹é‡æ“ä½œåŠŸèƒ½

### 2.1 éœ€æ±‚è¯´æ˜

- æ‰¹é‡é€‰æ‹©Provider
- æ‰¹é‡å¯ç”¨/ç¦ç”¨
- æ‰¹é‡åˆ é™¤
- å…¨é€‰/å–æ¶ˆå…¨é€‰

### 2.2 å®ç°æ–¹æ¡ˆ

#### æ­¥éª¤1: æ·»åŠ é€‰æ‹©çŠ¶æ€

```typescript
// æ‰¹é‡æ“ä½œçŠ¶æ€
const [selectedIds, setSelectedIds] = useState<number[]>([]);
const [showBatchActions, setShowBatchActions] = useState(false);
```

#### æ­¥éª¤2: é€‰æ‹©é€»è¾‘

```typescript
/**
 * åˆ‡æ¢å•ä¸ªProvideré€‰ä¸­çŠ¶æ€
 */
const toggleSelect = (id: number) => {
  setSelectedIds(prev => 
    prev.includes(id) 
      ? prev.filter(i => i !== id)
      : [...prev, id]
  );
};

/**
 * å…¨é€‰/å–æ¶ˆå…¨é€‰
 */
const toggleSelectAll = () => {
  const filteredProviders = getFilteredProviders();
  if (selectedIds.length === filteredProviders.length) {
    setSelectedIds([]);
  } else {
    setSelectedIds(filteredProviders.map(p => p.id));
  }
};

/**
 * æ‰¹é‡å¯ç”¨
 */
const batchEnable = async () => {
  try {
    await Promise.all(
      selectedIds.map(id => 
        APIProviderService.update(id, { api_status: 1 })
      )
    );
    await loadProviders();
    setSelectedIds([]);
    setToast({ message: `å·²å¯ç”¨ ${selectedIds.length} ä¸ªProvider`, type: 'success' });
  } catch (err: any) {
    setToast({ message: err.message || 'æ‰¹é‡æ“ä½œå¤±è´¥', type: 'error' });
  }
};

/**
 * æ‰¹é‡ç¦ç”¨
 */
const batchDisable = async () => {
  try {
    await Promise.all(
      selectedIds.map(id => 
        APIProviderService.update(id, { api_status: 0 })
      )
    );
    await loadProviders();
    setSelectedIds([]);
    setToast({ message: `å·²ç¦ç”¨ ${selectedIds.length} ä¸ªProvider`, type: 'success' });
  } catch (err: any) {
    setToast({ message: err.message || 'æ‰¹é‡æ“ä½œå¤±è´¥', type: 'error' });
  }
};

/**
 * æ‰¹é‡åˆ é™¤
 */
const batchDelete = async () => {
  if (!window.confirm(`ç¡®å®šè¦åˆ é™¤ ${selectedIds.length} ä¸ªProviderå—ï¼Ÿ`)) {
    return;
  }

  try {
    await Promise.all(
      selectedIds.map(id => APIProviderService.delete(id))
    );
    await loadProviders();
    setSelectedIds([]);
    setToast({ message: `å·²åˆ é™¤ ${selectedIds.length} ä¸ªProvider`, type: 'success' });
  } catch (err: any) {
    setToast({ message: err.message || 'æ‰¹é‡åˆ é™¤å¤±è´¥', type: 'error' });
  }
};
```

#### æ­¥éª¤3: æ·»åŠ æ‰¹é‡æ“ä½œæ UI

```typescript
{/* æ‰¹é‡æ“ä½œæ  */}
{selectedIds.length > 0 && (
  <div className="batch-actions-bar">
    <div className="batch-info">
      <input
        type="checkbox"
        checked={selectedIds.length === getFilteredProviders().length}
        onChange={toggleSelectAll}
        className="batch-checkbox"
      />
      <span>å·²é€‰æ‹© <strong>{selectedIds.length}</strong> é¡¹</span>
    </div>
    <div className="batch-buttons">
      <button className="btn btn-success" onClick={batchEnable}>
        âœ“ æ‰¹é‡å¯ç”¨
      </button>
      <button className="btn btn-warning" onClick={batchDisable}>
        âœ— æ‰¹é‡ç¦ç”¨
      </button>
      <button className="btn btn-danger" onClick={batchDelete}>
        ğŸ—‘ï¸ æ‰¹é‡åˆ é™¤
      </button>
      <button 
        className="btn btn-secondary" 
        onClick={() => setSelectedIds([])}
      >
        å–æ¶ˆé€‰æ‹©
      </button>
    </div>
  </div>
)}
```

#### æ­¥éª¤4: æ·»åŠ è¡¨æ ¼å¤é€‰æ¡†

åœ¨è¡¨æ ¼ç¬¬ä¸€åˆ—æ·»åŠ å¤é€‰æ¡†ï¼š

```typescript
<thead>
  <tr>
    <th style={{ width: '50px' }}>
      <input
        type="checkbox"
        checked={
          getFilteredProviders().length > 0 &&
          selectedIds.length === getFilteredProviders().length
        }
        onChange={toggleSelectAll}
        className="table-checkbox"
      />
    </th>
    <th>åç§°</th>
    {/* ...å…¶ä»–åˆ—... */}
  </tr>
</thead>

<tbody>
  {getFilteredProviders().map((provider) => (
    <tr 
      key={provider.id}
      className={selectedIds.includes(provider.id) ? 'selected' : ''}
    >
      <td>
        <input
          type="checkbox"
          checked={selectedIds.includes(provider.id)}
          onChange={() => toggleSelect(provider.id)}
          className="table-checkbox"
        />
      </td>
      {/* ...å…¶ä»–åˆ—... */}
    </tr>
  ))}
</tbody>
```

#### æ­¥éª¤5: æ·»åŠ CSSæ ·å¼

```css
/* æ‰¹é‡æ“ä½œæ  */
.batch-actions-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #667eea;
  color: white;
  padding: 1rem 1.5rem;
  border-radius: 12px;
  margin-bottom: 1rem;
  box-shadow: 0 4px 6px rgba(102, 126, 234, 0.3);
}

.batch-info {
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1rem;
}

.batch-info strong {
  font-weight: 700;
  font-size: 1.1rem;
}

.batch-buttons {
  display: flex;
  gap: 0.75rem;
}

.batch-buttons .btn {
  padding: 0.6rem 1.2rem;
  font-size: 0.9rem;
}

.btn-success {
  background: #48bb78;
  color: white;
}

.btn-success:hover {
  background: #38a169;
}

.btn-warning {
  background: #ed8936;
  color: white;
}

.btn-warning:hover {
  background: #dd6b20;
}

.btn-danger {
  background: #f56565;
  color: white;
}

.btn-danger:hover {
  background: #e53e3e;
}

/* å¤é€‰æ¡†æ ·å¼ */
.table-checkbox,
.batch-checkbox {
  width: 18px;
  height: 18px;
  cursor: pointer;
  accent-color: #667eea;
}

/* é€‰ä¸­è¡Œé«˜äº® */
.provider-table tbody tr.selected {
  background-color: #edf2f7;
  border-left: 3px solid #667eea;
}

/* å“åº”å¼ */
@media (max-width: 768px) {
  .batch-actions-bar {
    flex-direction: column;
    gap: 1rem;
  }

  .batch-buttons {
    width: 100%;
    flex-wrap: wrap;
  }

  .batch-buttons .btn {
    flex: 1;
    min-width: 120px;
  }
}
```

---

## ğŸ§ª 3. Providerè¿æ¥æµ‹è¯•åŠŸèƒ½

### 3.1 éœ€æ±‚è¯´æ˜

- æµ‹è¯•Provideré…ç½®æ˜¯å¦æ­£ç¡®
- éªŒè¯APIå¯†é’¥æœ‰æ•ˆæ€§
- æ˜¾ç¤ºæµ‹è¯•ç»“æœ

### 3.2 å®ç°æ–¹æ¡ˆ

#### æ­¥éª¤1: æ·»åŠ æµ‹è¯•çŠ¶æ€

```typescript
const [testingId, setTestingId] = useState<number | null>(null);
```

#### æ­¥éª¤2: å®ç°æµ‹è¯•é€»è¾‘

```typescript
/**
 * æµ‹è¯•Providerè¿æ¥
 */
const testConnection = async (provider: APIProvider) => {
  setTestingId(provider.id);
  
  try {
    // æ¨¡æ‹ŸAPIæµ‹è¯•ï¼ˆå®é™…åº”è°ƒç”¨åç«¯æµ‹è¯•æ¥å£ï¼‰
    await new Promise(resolve => setTimeout(resolve, 2000));
    
    // è¿™é‡Œåº”è¯¥è°ƒç”¨å®é™…çš„æµ‹è¯•æ¥å£
    // const result = await APIProviderService.test(provider.id);
    
    setToast({
      message: `Provider "${provider.name}" è¿æ¥æˆåŠŸ`,
      type: 'success',
    });
  } catch (err: any) {
    setToast({
      message: `è¿æ¥å¤±è´¥: ${err.message}`,
      type: 'error',
    });
  } finally {
    setTestingId(null);
  }
};
```

#### æ­¥éª¤3: æ·»åŠ æµ‹è¯•æŒ‰é’®

åœ¨æ“ä½œåˆ—æ·»åŠ æµ‹è¯•æŒ‰é’®ï¼š

```typescript
<td>
  <div className="action-buttons">
    <button
      className="btn-icon btn-test"
      onClick={() => testConnection(provider)}
      disabled={testingId === provider.id}
      title="æµ‹è¯•è¿æ¥"
    >
      {testingId === provider.id ? 'â³' : 'ğŸ”Œ'}
    </button>
    <button
      className="btn-icon btn-edit"
      onClick={() => handleEdit(provider)}
      title="ç¼–è¾‘"
    >
      âœï¸
    </button>
    <button
      className="btn-icon btn-delete"
      onClick={() => handleDelete(provider.id, provider.name)}
      title="åˆ é™¤"
    >
      ğŸ—‘ï¸
    </button>
  </div>
</td>
```

#### æ­¥éª¤4: æ·»åŠ CSSæ ·å¼

```css
.btn-icon.btn-test {
  color: #48bb78;
}

.btn-icon.btn-test:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}
```

### 3.3 åç«¯æµ‹è¯•æ¥å£ï¼ˆå»ºè®®ï¼‰

åœ¨åç«¯æ·»åŠ æµ‹è¯•æ¥å£ï¼š

```go
// backend/api/handlers/api_provider_handler.go

// TestAPIProviderHandler æµ‹è¯•API Providerè¿æ¥
func TestAPIProviderHandler(c *gin.Context) {
    userMobile, _ := c.Get("mobile")
    idStr := c.Param("id")
    id, _ := strconv.ParseUint(idStr, 10, 64)

    // è·å–Provideré…ç½®
    provider, err := services.GetAPIProvider(userMobile.(string), uint(id))
    if err != nil {
        utils.ResponseError(&ctx, c, utils.CodeServerBusy, "è·å–Providerå¤±è´¥")
        return
    }

    // è§£å¯†API Key
    apiKey, err := services.GetDecryptedAPIKey(provider)
    if err != nil {
        utils.ResponseError(&ctx, c, utils.CodeServerBusy, "è§£å¯†API Keyå¤±è´¥")
        return
    }

    // æµ‹è¯•APIè¿æ¥ï¼ˆç®€å•çš„HTTPè¯·æ±‚æµ‹è¯•ï¼‰
    client := &http.Client{Timeout: 10 * time.Second}
    req, _ := http.NewRequest("GET", provider.APIURL, nil)
    req.Header.Set("Authorization", "Bearer "+apiKey)
    
    resp, err := client.Do(req)
    if err != nil {
        utils.ResponseError(&ctx, c, utils.CodeServerBusy, "è¿æ¥å¤±è´¥: "+err.Error())
        return
    }
    defer resp.Body.Close()

    if resp.StatusCode == 200 || resp.StatusCode == 401 {
        // 200æˆ–401éƒ½è¯´æ˜æœåŠ¡å™¨å¯è¾¾
        utils.ResponseSuccess(&ctx, c, gin.H{
            "status": "connected",
            "message": "è¿æ¥æˆåŠŸ",
        })
    } else {
        utils.ResponseError(&ctx, c, utils.CodeServerBusy, 
            fmt.Sprintf("è¿æ¥å¤±è´¥ï¼ŒçŠ¶æ€ç : %d", resp.StatusCode))
    }
}
```

---

## ğŸ¨ 4. åŠ¨ç”»ä¼˜åŒ–

### 4.1 éœ€æ±‚è¯´æ˜

- é¡µé¢åŠ è½½åŠ¨ç”»
- è¡¨æ ¼è¡Œhoveræ•ˆæœ
- æŒ‰é’®ç‚¹å‡»åé¦ˆ
- è¿‡æ¸¡åŠ¨ç”»

### 4.2 å®ç°æ–¹æ¡ˆ

åœ¨ `apiconfig.css` ä¸­æ·»åŠ åŠ¨ç”»ï¼š

```css
/* é¡µé¢æ·¡å…¥åŠ¨ç”» */
.api-config-page {
  animation: fadeIn 0.3s ease-in-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* è¡¨æ ¼è¡ŒåŠ¨ç”» */
.provider-table tbody tr {
  transition: all 0.2s ease;
}

.provider-table tbody tr:hover {
  transform: translateX(4px);
  box-shadow: -4px 0 0 #667eea;
}

/* å¡ç‰‡å¼¹å‡ºåŠ¨ç”» */
.modal-content {
  animation: slideUp 0.3s ease-out;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(50px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* æŒ‰é’®ç‚¹å‡»æ•ˆæœ */
.btn {
  position: relative;
  overflow: hidden;
  transition: all 0.2s;
}

.btn:active {
  transform: scale(0.95);
}

.btn::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
  transform: translate(-50%, -50%);
  transition: width 0.6s, height 0.6s;
}

.btn:active::after {
  width: 300px;
  height: 300px;
}

/* çŠ¶æ€æ ‡ç­¾åˆ‡æ¢åŠ¨ç”» */
.status-badge,
.open-badge {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.status-badge:active,
.open-badge:active {
  transform: scale(0.9);
}

/* åŠ è½½åŠ¨ç”»ä¼˜åŒ– */
.loading-spinner {
  animation: spin 1s cubic-bezier(0.5, 0, 0.5, 1) infinite;
}

@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

/* æœç´¢æ¡†èšç„¦åŠ¨ç”» */
.search-box {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.search-box:focus-within {
  transform: translateY(-2px);
}

/* Toastæ¶ˆæ¯æ»‘å…¥åŠ¨ç”» */
@keyframes slideInRight {
  from {
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

/* åˆ é™¤è¡Œæ·¡å‡ºåŠ¨ç”» */
@keyframes fadeOut {
  from {
    opacity: 1;
    max-height: 100px;
  }
  to {
    opacity: 0;
    max-height: 0;
    padding: 0;
    margin: 0;
  }
}

.provider-table tbody tr.deleting {
  animation: fadeOut 0.3s ease-out forwards;
}
```

### 4.3 æ·»åŠ éª¨æ¶å±

```typescript
// åŠ è½½éª¨æ¶å±ç»„ä»¶
const LoadingSkeleton = () => (
  <div className="skeleton-container">
    {[1, 2, 3, 4, 5].map((i) => (
      <div key={i} className="skeleton-row">
        <div className="skeleton-cell skeleton-shimmer" />
        <div className="skeleton-cell skeleton-shimmer" />
        <div className="skeleton-cell skeleton-shimmer" />
      </div>
    ))}
  </div>
);
```

CSS:

```css
.skeleton-container {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.skeleton-row {
  display: flex;
  gap: 1rem;
  margin-bottom: 1rem;
}

.skeleton-cell {
  height: 40px;
  background: #e2e8f0;
  border-radius: 8px;
  flex: 1;
}

.skeleton-shimmer {
  background: linear-gradient(
    90deg,
    #e2e8f0 0%,
    #edf2f7 50%,
    #e2e8f0 100%
  );
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
}

@keyframes shimmer {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}
```

---

## ğŸ’¾ 5. æœ¬åœ°ç¼“å­˜ç­–ç•¥

### 5.1 éœ€æ±‚è¯´æ˜

- ç¼“å­˜Provideråˆ—è¡¨
- å‡å°‘ä¸å¿…è¦çš„APIè°ƒç”¨
- è‡ªåŠ¨åˆ·æ–°ç­–ç•¥

### 5.2 å®ç°æ–¹æ¡ˆ

```typescript
// ç¼“å­˜é”®
const CACHE_KEY = 'api_providers_cache';
const CACHE_EXPIRY_KEY = 'api_providers_cache_expiry';
const CACHE_DURATION = 5 * 60 * 1000; // 5åˆ†é’Ÿ

/**
 * ä»ç¼“å­˜åŠ è½½æ•°æ®
 */
const loadFromCache = (): APIProvider[] | null => {
  try {
    const cached = localStorage.getItem(CACHE_KEY);
    const expiry = localStorage.getItem(CACHE_EXPIRY_KEY);
    
    if (!cached || !expiry) {
      return null;
    }

    const expiryTime = parseInt(expiry, 10);
    if (Date.now() > expiryTime) {
      // ç¼“å­˜è¿‡æœŸ
      localStorage.removeItem(CACHE_KEY);
      localStorage.removeItem(CACHE_EXPIRY_KEY);
      return null;
    }

    return JSON.parse(cached);
  } catch (error) {
    console.error('Failed to load cache:', error);
    return null;
  }
};

/**
 * ä¿å­˜åˆ°ç¼“å­˜
 */
const saveToCache = (data: APIProvider[]) => {
  try {
    localStorage.setItem(CACHE_KEY, JSON.stringify(data));
    localStorage.setItem(
      CACHE_EXPIRY_KEY,
      (Date.now() + CACHE_DURATION).toString()
    );
  } catch (error) {
    console.error('Failed to save cache:', error);
  }
};

/**
 * æ¸…é™¤ç¼“å­˜
 */
const clearCache = () => {
  localStorage.removeItem(CACHE_KEY);
  localStorage.removeItem(CACHE_EXPIRY_KEY);
};

/**
 * åŠ è½½Provideråˆ—è¡¨ï¼ˆå¸¦ç¼“å­˜ï¼‰
 */
const loadProviders = async (forceRefresh = false) => {
  // å°è¯•ä»ç¼“å­˜åŠ è½½
  if (!forceRefresh) {
    const cached = loadFromCache();
    if (cached) {
      setProviders(cached);
      setLoading(false);
      return;
    }
  }

  setLoading(true);
  setError(null);

  try {
    const result = await APIProviderService.list();
    const data = result.list || [];
    setProviders(data);
    saveToCache(data); // ä¿å­˜åˆ°ç¼“å­˜
  } catch (err: any) {
    setError(err.message || 'åŠ è½½ API Provider åˆ—è¡¨å¤±è´¥');
  } finally {
    setLoading(false);
  }
};
```

### 5.3 æ·»åŠ æ‰‹åŠ¨åˆ·æ–°æŒ‰é’®

```typescript
<button 
  className="btn btn-secondary" 
  onClick={() => loadProviders(true)}
  title="åˆ·æ–°åˆ—è¡¨"
>
  ğŸ”„ åˆ·æ–°
</button>
```

---

## ğŸ“Š 6. å®ç°ä¼˜å…ˆçº§å»ºè®®

æ ¹æ®å®ç”¨æ€§å’Œå¼€å‘éš¾åº¦ï¼Œå»ºè®®æŒ‰ä»¥ä¸‹é¡ºåºå®ç°ï¼š

| ä¼˜å…ˆçº§ | åŠŸèƒ½ | å¼€å‘éš¾åº¦ | ç”¨æˆ·ä»·å€¼ | é¢„è®¡æ—¶é—´ |
|--------|------|---------|---------|---------|
| â­â­â­ | æœç´¢å’Œè¿‡æ»¤ | ä½ | é«˜ | 2å°æ—¶ |
| â­â­â­ | åŠ¨ç”»ä¼˜åŒ– | ä½ | ä¸­ | 1å°æ—¶ |
| â­â­ | æ‰¹é‡æ“ä½œ | ä¸­ | ä¸­ | 3å°æ—¶ |
| â­â­ | æœ¬åœ°ç¼“å­˜ | ä½ | ä¸­ | 1å°æ—¶ |
| â­ | è¿æ¥æµ‹è¯• | é«˜ | ä¸­ | 4å°æ—¶ï¼ˆå«åç«¯ï¼‰|

## ğŸ¯ æ€»ç»“

æœ¬æŒ‡å—æä¾›äº†5ä¸ªæ ¸å¿ƒå¢å¼ºåŠŸèƒ½çš„è¯¦ç»†å®ç°æ–¹æ¡ˆï¼š

1. **æœç´¢å’Œè¿‡æ»¤** - æå‡æŸ¥æ‰¾æ•ˆç‡
2. **æ‰¹é‡æ“ä½œ** - æé«˜ç®¡ç†æ•ˆç‡
3. **è¿æ¥æµ‹è¯•** - éªŒè¯é…ç½®æ­£ç¡®æ€§
4. **åŠ¨ç”»ä¼˜åŒ–** - æå‡ç”¨æˆ·ä½“éªŒ
5. **æœ¬åœ°ç¼“å­˜** - å‡å°‘APIè°ƒç”¨ï¼Œæå‡æ€§èƒ½

æ‰€æœ‰åŠŸèƒ½éƒ½ç»è¿‡ç²¾å¿ƒè®¾è®¡ï¼Œç¡®ä¿ï¼š
- âœ… ä»£ç ç®€æ´æ˜“ç»´æŠ¤
- âœ… UI/UXå‹å¥½
- âœ… æ€§èƒ½ä¼˜ç§€
- âœ… å“åº”å¼è®¾è®¡
- âœ… æ¸è¿›å¢å¼º

å¼€å‘è€…å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©æ€§å®ç°è¿™äº›åŠŸèƒ½ã€‚æ¯ä¸ªåŠŸèƒ½éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå¯ä»¥å•ç‹¬æ·»åŠ è€Œä¸å½±å“ç°æœ‰åŠŸèƒ½ã€‚
