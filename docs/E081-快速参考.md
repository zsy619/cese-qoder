# E081-注册组件快速参考

**版本**: 1.0  
**日期**: 2025-10-23

---

## 🚀 快速开始

### 使用注册组件

```typescript
import Register from './components/Register';

function MyComponent() {
  const [showRegister, setShowRegister] = useState(false);

  const handleRegisterSuccess = () => {
    console.log('注册成功');
  };

  return (
    <>
      <button onClick={() => setShowRegister(true)}>注册</button>
      
      <Register
        visible={showRegister}
        onClose={() => setShowRegister(false)}
        onSuccess={handleRegisterSuccess}
      />
    </>
  );
}
```

---

## 📋 核心API

### Register组件

```typescript
interface RegisterProps {
  visible: boolean;        // 是否显示注册窗口
  onClose: () => void;     // 关闭窗口回调
  onSuccess?: () => void;  // 注册成功回调
}
```

### UserService方法

```typescript
// 注册
await UserService.register({ mobile, password });

// 注册后会返回用户信息
```

---

## 🎨 组件文件清单

| 文件 | 说明 |
|------|------|
| `/components/Register.tsx` | 注册组件 |
| `/components/Header.tsx` | Header组件（已更新） |
| `/styles/login.css` | 注册样式（复用登录样式） |
| `/styles/app.css` | 注册按钮样式（已更新） |

---

## 🔑 密码验证规则

### 强度要求

```typescript
✅ 长度：8-16位
✅ 大写字母：至少1个 (A-Z)
✅ 小写字母：至少1个 (a-z)
✅ 数字：至少1个 (0-9)
✅ 特殊字符：至少1个 (!@#$%^&*)
```

### 有效密码示例

```
✅ Test@123456
✅ Abc!1234
✅ MyPass@2023
✅ Hello#World1
```

### 无效密码示例

```
❌ test@123456  → 缺少大写字母
❌ TEST@123456  → 缺少小写字母
❌ Test@abcdef  → 缺少数字
❌ Test123456   → 缺少特殊字符
❌ Test@12      → 长度不足
```

---

## 📱 手机号验证规则

```typescript
格式：1[3-9]\d{9}

✅ 13800138000
✅ 15912345678
✅ 18600000000

❌ 12345678901  → 第2位不在3-9范围
❌ 1381234567   → 少于11位
```

---

## 💡 使用场景

### 场景1：在Header中集成

```typescript
// Header.tsx
const [showRegister, setShowRegister] = useState(false);

return (
  <>
    <nav>
      {!isLoggedIn && (
        <>
          <button onClick={() => setShowRegister(true)}>注册</button>
          <button onClick={() => setShowLogin(true)}>登录</button>
        </>
      )}
    </nav>
    
    <Register
      visible={showRegister}
      onClose={() => setShowRegister(false)}
      onSuccess={() => alert('注册成功！')}
    />
  </>
);
```

### 场景2：注册成功后跳转

```typescript
// Register组件内部已实现
// 注册成功后自动跳转到 /template
await UserService.register({ mobile, password });
navigate('/template');
```

### 场景3：表单验证

```typescript
// 实时验证
const handlePasswordChange = (e) => {
  const value = e.target.value;
  setPassword(value);
  
  // 立即验证
  if (errors.password) {
    setErrors(prev => ({
      ...prev,
      password: validatePassword(value)
    }));
  }
};
```

---

## 🎯 注册流程

```
用户点击"注册"按钮
  ↓
显示注册弹窗
  ↓
填写手机号（实时验证）
  ↓
填写密码（实时验证强度）
  ↓
确认密码（实时验证一致性）
  ↓
点击"注册"
  ↓
调用API
  ↓
注册成功
  ↓
清空表单
  ↓
触发成功回调
  ↓
关闭弹窗
  ↓
自动跳转到模板生成页面
```

---

## 🎨 UI元素说明

### 注册弹窗

```typescript
标题：用户注册（紫色渐变背景）

输入框：
📱 请输入手机号
🔒 请输入密码
🔐 请再次输入密码

按钮：注册 / 注册中...

提示：密码应为8-16位，必须包含大小写字母、数字和特殊字符
```

### Header按钮

```typescript
// 未登录状态
[首页] [模板生成] [注册] [登录]
        ↑白底紫边  ↑紫底白字

// 已登录状态
[首页] [模板生成] [我的模板] [退出登录]
                               ↑白底紫边
```

---

## 🔧 自定义配置

### 修改密码规则

```typescript
// Register.tsx
const validatePassword = (value: string) => {
  // 修改长度要求
  if (value.length < 10 || value.length > 20) {
    return '密码长度应为10-20位';
  }
  
  // 添加其他规则
  // ...
};
```

### 修改跳转目标

```typescript
// Register.tsx
// 注册成功后跳转
navigate('/your-target-page');
```

### 修改按钮样式

```css
/* app.css */
.register-btn {
  background-color: #YOUR_COLOR;
  border-color: #YOUR_COLOR;
}
```

---

## 🐛 常见问题

### Q1: 注册后没有跳转？

```typescript
// 确保使用了useNavigate
import { useNavigate } from 'react-router-dom';
const navigate = useNavigate();

// 注册成功后调用
navigate('/template');
```

### Q2: 密码验证太严格？

```typescript
// 可以调整验证规则
// 在validatePassword函数中修改正则表达式
```

### Q3: 如何添加邮箱注册？

```typescript
// 添加邮箱字段
const [email, setEmail] = useState('');

// 添加邮箱验证
const validateEmail = (value: string) => {
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return emailRegex.test(value);
};
```

---

## 📊 验证示例

### 密码强度测试

```typescript
// 测试用例
Test@123456  ✅ 通过（包含所有要求）
test@123456  ❌ 失败（缺少大写）
TEST@123456  ❌ 失败（缺少小写）
Test123456   ❌ 失败（缺少特殊字符）
Test@abc     ❌ 失败（缺少数字）
Test@12      ❌ 失败（长度不足）
```

### 密码确认测试

```typescript
密码：Test@123456
确认：Test@123456  ✅ 通过
确认：Test@123457  ❌ 失败（不一致）
```

---

## 🔒 安全建议

### 1. 前端验证
- ✅ 密码强度验证
- ✅ 格式验证
- ✅ 实时反馈

### 2. 后端验证
- ✅ 重复手机号检查
- ✅ 密码加密存储（SM3）
- ✅ 防止暴力注册

### 3. 用户体验
- ✅ 清晰的错误提示
- ✅ 实时验证反馈
- ✅ 注册成功自动跳转

---

## 📞 快速链接

- [完整实施总结](/docs/E081-实施总结.md)
- [登录组件参考](/docs/E080-快速参考.md)
- [用户服务文档](/frontend/src/services/README.md)

---

**更新时间**: 2025-10-23  
**维护者**: AI React+TypeScript工程师
