# HTTPå“åº”ç¼–ç ä¿®å¤ - å¯¹æ¯”ç¤ºä¾‹

## ğŸ“Š ä¿®å¤å‰åå¯¹æ¯”

### ä¿®å¤å‰çš„HTTPå“åº”

```http
HTTP/1.1 200 OK
Content-Type: application/json
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS
Access-Control-Allow-Headers: Content-Type, Authorization
Content-Length: 358

{
  "code": 0,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "mobile": "13800138000",
        "topic": "å†™ä½œåŠ©æ‰‹",
        "task_objective": "å¸®åŠ©ç”¨æˆ·ç”Ÿæˆé«˜è´¨é‡çš„æ–‡ç« å†…å®¹",
        "ai_role": "å†™ä½œä¸“å®¶",
        "my_role": "å†…å®¹åˆ›ä½œè€…",
        "created_at": "2025-10-23T10:00:00+08:00"
      }
    ],
    "total": 1,
    "page": 1,
    "page_size": 10
  }
}
```

**é—®é¢˜**ï¼š
- âŒ `Content-Type: application/json` ç¼ºå°‘ `charset=utf-8`
- âŒ æµè§ˆå™¨å¯èƒ½ä½¿ç”¨ISO-8859-1æˆ–å…¶ä»–ç¼–ç è§£æ
- âŒ ä¸­æ–‡æ˜¾ç¤ºä¸ºä¹±ç ï¼š`ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½` æˆ– `éæ¬ç¶”é”â•‚å¢œ`

---

### ä¿®å¤åçš„HTTPå“åº”

```http
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS
Access-Control-Allow-Headers: Content-Type, Authorization
Content-Length: 358

{
  "code": 0,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "mobile": "13800138000",
        "topic": "å†™ä½œåŠ©æ‰‹",
        "task_objective": "å¸®åŠ©ç”¨æˆ·ç”Ÿæˆé«˜è´¨é‡çš„æ–‡ç« å†…å®¹",
        "ai_role": "å†™ä½œä¸“å®¶",
        "my_role": "å†…å®¹åˆ›ä½œè€…",
        "created_at": "2025-10-23T10:00:00+08:00"
      }
    ],
    "total": 1,
    "page": 1,
    "page_size": 10
  }
}
```

**æ”¹è¿›**ï¼š
- âœ… `Content-Type: application/json; charset=utf-8` æ˜ç¡®æŒ‡å®šUTF-8
- âœ… æµè§ˆå™¨æ­£ç¡®ä½¿ç”¨UTF-8è§£æ
- âœ… ä¸­æ–‡æ­£ç¡®æ˜¾ç¤ºï¼š`å†™ä½œåŠ©æ‰‹`ã€`å¸®åŠ©ç”¨æˆ·ç”Ÿæˆé«˜è´¨é‡çš„æ–‡ç« å†…å®¹`

---

## ğŸ” æµè§ˆå™¨è§£æè¿‡ç¨‹

### ä¿®å¤å‰çš„è§£ææµç¨‹

```
1. æµè§ˆå™¨æ¥æ”¶å“åº”
   â†“
2. æ£€æŸ¥Content-Type: application/json
   â†“
3. æ²¡æœ‰charsetå‚æ•°ï¼Œå¼€å§‹çŒœæµ‹ç¼–ç 
   â†“
4. å¯èƒ½çŒœæµ‹ä¸ºISO-8859-1ï¼ˆé»˜è®¤ï¼‰
   â†“
5. ä½¿ç”¨ISO-8859-1è§£æUTF-8ç¼–ç çš„å­—èŠ‚
   â†“
6. è§£æå¤±è´¥ â†’ æ˜¾ç¤ºä¹±ç 
```

**ä¾‹å¦‚**ï¼š
```
UTF-8å­—èŠ‚: E5 86 99 E4 BD 9C E5 8A A9 E6 89 8B
         â†“ (ç”¨ISO-8859-1è§£æ)
æ˜¾ç¤ºç»“æœ: Ã¥â€ â„¢Ã¤Â½Å“Ã¥Â©Ã¦
```

### ä¿®å¤åçš„è§£ææµç¨‹

```
1. æµè§ˆå™¨æ¥æ”¶å“åº”
   â†“
2. æ£€æŸ¥Content-Type: application/json; charset=utf-8
   â†“
3. æ˜ç¡®çŸ¥é“ä½¿ç”¨UTF-8ç¼–ç 
   â†“
4. ä½¿ç”¨UTF-8è§£æå­—èŠ‚æµ
   â†“
5. è§£ææˆåŠŸ â†’ æ­£ç¡®æ˜¾ç¤ºä¸­æ–‡
```

**ä¾‹å¦‚**ï¼š
```
UTF-8å­—èŠ‚: E5 86 99 E4 BD 9C E5 8A A9 E6 89 8B
         â†“ (ç”¨UTF-8è§£æ)
æ˜¾ç¤ºç»“æœ: å†™ä½œåŠ©æ‰‹ âœ“
```

---

## ğŸ“ ä»£ç ä¿®æ”¹ç¤ºä¾‹

### response.go ä¿®æ”¹

**ä¿®æ”¹å‰**ï¼š
```go
func Success(c *context.Context, ctx *app.RequestContext, data interface{}) {
	ctx.JSON(consts.StatusOK, Response{
		Code:    CodeSuccess,
		Message: "success",
		Data:    data,
	})
}
```

**ä¿®æ”¹å**ï¼š
```go
func Success(c *context.Context, ctx *app.RequestContext, data interface{}) {
	// è®¾ç½®å“åº”å¤´ï¼Œæ˜ç¡®æŒ‡å®šUTF-8ç¼–ç 
	ctx.Response.Header.Set("Content-Type", "application/json; charset=utf-8")
	ctx.JSON(consts.StatusOK, Response{
		Code:    CodeSuccess,
		Message: "success",
		Data:    data,
	})
}
```

**å…³é”®å˜åŒ–**ï¼š
- æ·»åŠ äº† `ctx.Response.Header.Set("Content-Type", "application/json; charset=utf-8")`
- åœ¨è°ƒç”¨ `ctx.JSON()` ä¹‹å‰æ˜ç¡®è®¾ç½®å“åº”å¤´

---

## ğŸ§ª æµ‹è¯•ç”¨ä¾‹

### 1. åˆ›å»ºä¸­æ–‡æ¨¡æ¿æµ‹è¯•

**è¯·æ±‚**ï¼š
```bash
curl -X POST http://localhost:8080/api/v1/template \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json; charset=utf-8" \
  -d '{
    "topic": "ä¸­æ–‡æµ‹è¯•æ¨¡æ¿",
    "task_objective": "æµ‹è¯•ä¸­æ–‡æ˜¾ç¤ºæ˜¯å¦æ­£å¸¸",
    "ai_role": "AIåŠ©æ‰‹",
    "my_role": "æµ‹è¯•äººå‘˜"
  }'
```

**ä¿®å¤å‰å“åº”**ï¼š
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "id": 10,
    "topic": "ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½",  // ä¹±ç 
    "task_objective": "ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½",  // ä¹±ç 
    ...
  }
}
```

**ä¿®å¤åå“åº”**ï¼š
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "id": 10,
    "topic": "ä¸­æ–‡æµ‹è¯•æ¨¡æ¿",  // æ­£å¸¸
    "task_objective": "æµ‹è¯•ä¸­æ–‡æ˜¾ç¤ºæ˜¯å¦æ­£å¸¸",  // æ­£å¸¸
    ...
  }
}
```

### 2. è·å–æ¨¡æ¿åˆ—è¡¨æµ‹è¯•

**è¯·æ±‚**ï¼š
```bash
curl -i -H "Authorization: Bearer $TOKEN" \
  http://localhost:8080/api/v1/template?page=1&page_size=10
```

**ä¿®å¤å‰å“åº”å¤´**ï¼š
```http
HTTP/1.1 200 OK
Content-Type: application/json
```

**ä¿®å¤åå“åº”å¤´**ï¼š
```http
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
```

---

## ğŸŒ æµè§ˆå™¨å¼€å‘è€…å·¥å…·éªŒè¯

### Chrome DevTools éªŒè¯æ­¥éª¤

1. **æ‰“å¼€å¼€å‘è€…å·¥å…·**ï¼šF12 æˆ– Cmd+Option+I
2. **åˆ‡æ¢åˆ° Network æ ‡ç­¾**
3. **åˆ·æ–°é¡µé¢æˆ–è§¦å‘APIè¯·æ±‚**
4. **ç‚¹å‡»è¯·æ±‚æŸ¥çœ‹è¯¦æƒ…**

**ä¿®å¤å‰**ï¼š
```
Request Headers:
  Accept: application/json
  
Response Headers:
  Content-Type: application/json  â† ç¼ºå°‘charset
  
Preview:
  topic: "ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½"  â† ä¹±ç 
```

**ä¿®å¤å**ï¼š
```
Request Headers:
  Accept: application/json
  
Response Headers:
  Content-Type: application/json; charset=utf-8  â† åŒ…å«charset
  
Preview:
  topic: "å†™ä½œåŠ©æ‰‹"  â† æ­£å¸¸æ˜¾ç¤º
```

---

## ğŸ“± å‰ç«¯æ˜¾ç¤ºæ•ˆæœ

### æˆ‘çš„æ¨¡æ¿é¡µé¢

**ä¿®å¤å‰**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æˆ‘çš„æ¨¡æ¿                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½                    â”‚  â† ä¹±ç 
â”‚ ä»»åŠ¡ç›®æ ‡ï¼šï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½   â”‚  â† ä¹±ç 
â”‚ AIè§’è‰²ï¼šï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½            â”‚  â† ä¹±ç 
â”‚                                 â”‚
â”‚ [å¯¼å‡ºMD] [å¯¼å‡ºJSON] [åˆ é™¤]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¿®å¤å**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æˆ‘çš„æ¨¡æ¿                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å†™ä½œåŠ©æ‰‹                        â”‚  â† æ­£å¸¸
â”‚ ä»»åŠ¡ç›®æ ‡ï¼šå¸®åŠ©ç”¨æˆ·ç”Ÿæˆé«˜è´¨é‡... â”‚  â† æ­£å¸¸
â”‚ AIè§’è‰²ï¼šå†™ä½œä¸“å®¶                â”‚  â† æ­£å¸¸
â”‚                                 â”‚
â”‚ [å¯¼å‡ºMD] [å¯¼å‡ºJSON] [åˆ é™¤]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ å…¶ä»–è¯­è¨€çš„ä¿®å¤æ–¹å¼

### Node.js (Express)
```javascript
// ä¿®å¤å‰
res.json({ code: 0, data: result });

// ä¿®å¤å
res.setHeader('Content-Type', 'application/json; charset=utf-8');
res.json({ code: 0, data: result });
```

### Java (Spring Boot)
```java
// ä¿®å¤å‰
@GetMapping("/template")
public Response getTemplates() {
    return Response.success(data);
}

// ä¿®å¤å
@GetMapping(value = "/template", produces = "application/json; charset=UTF-8")
public Response getTemplates() {
    return Response.success(data);
}
```

### Python (Flask)
```python
# ä¿®å¤å‰
return jsonify({'code': 0, 'data': data})

# ä¿®å¤å
response = jsonify({'code': 0, 'data': data})
response.headers['Content-Type'] = 'application/json; charset=utf-8'
return response
```

---

## ğŸ“Š éªŒè¯æ¸…å•

ä½¿ç”¨æ­¤æ¸…å•éªŒè¯ä¿®å¤æ˜¯å¦æˆåŠŸï¼š

- [ ] åç«¯æœåŠ¡å·²é‡å¯
- [ ] ä½¿ç”¨curlæ£€æŸ¥å“åº”å¤´åŒ…å« `charset=utf-8`
- [ ] æµè§ˆå™¨å¼€å‘è€…å·¥å…·ä¸­çœ‹åˆ°æ­£ç¡®çš„Content-Type
- [ ] å‰ç«¯é¡µé¢ä¸­æ–‡æ˜¾ç¤ºæ­£å¸¸
- [ ] åˆ›å»ºæ–°æ¨¡æ¿æ—¶ä¸­æ–‡æ­£å¸¸
- [ ] ç¼–è¾‘æ¨¡æ¿æ—¶ä¸­æ–‡æ­£å¸¸
- [ ] å¯¼å‡ºæ–‡ä»¶æ—¶ä¸­æ–‡æ­£å¸¸

---

## ğŸ’¡ å…³é”®è¦ç‚¹

1. **HTTPåè®®æœ¬èº«æ˜¯å­—èŠ‚æµä¼ è¾“**ï¼Œä¸å…³å¿ƒå­—ç¬¦ç¼–ç 
2. **Content-Typeå¤´æ˜¯å‘Šè¯‰æµè§ˆå™¨å¦‚ä½•è§£æçš„å”¯ä¸€é€”å¾„**
3. **UTF-8æ˜¯æ¨èçš„Webæ ‡å‡†ç¼–ç **ï¼Œæ”¯æŒå…¨çƒæ‰€æœ‰è¯­è¨€
4. **å§‹ç»ˆæ˜ç¡®æŒ‡å®šcharset**ï¼Œä¸è¦ä¾èµ–æµè§ˆå™¨çŒœæµ‹
5. **ä¿®å¤åº”è¯¥åœ¨æœåŠ¡ç«¯ç»Ÿä¸€å¤„ç†**ï¼Œä¸è¦ä¾èµ–å®¢æˆ·ç«¯

---

## ğŸ“ å­¦ä¹ èµ„æº

- [RFC 3629: UTF-8](https://tools.ietf.org/html/rfc3629)
- [RFC 7231: HTTP Semantics - Content-Type](https://tools.ietf.org/html/rfc7231#section-3.1.1.5)
- [MDN: Content-Type](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Type)
- [å­—ç¬¦ç¼–ç ç¬”è®°ï¼šASCIIï¼ŒUnicode å’Œ UTF-8](http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html)

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**åˆ›å»ºæ—¶é—´**ï¼š2025-10-23  
**é€‚ç”¨é¡¹ç›®**ï¼šCESE-Qoder ä¸Šä¸‹æ–‡å·¥ç¨‹å…­è¦ç´ å·¥å…·
