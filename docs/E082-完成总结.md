# E082 ä»»åŠ¡å®Œæˆæ€»ç»“

## ä»»åŠ¡æ¦‚è¿°

**ä»»åŠ¡ç¼–å·**: E082  
**ä»»åŠ¡æ ‡é¢˜**: APIProviderè¡¨ç»“æ„è°ƒæ•´ - ç§»é™¤api_secretå’Œapi_typeå­—æ®µ  
**å®Œæˆæ—¥æœŸ**: 2025-10-23  
**æ‰§è¡Œäºº**: Qoder AI

## ä»»åŠ¡ç›®æ ‡

è°ƒæ•´API Providerè¡¨ç»“æ„ï¼Œç§»é™¤ä¸å¿…è¦çš„å­—æ®µä»¥ç®€åŒ–ç³»ç»Ÿè®¾è®¡ï¼š

1. âœ… ç§»é™¤ `api_secret` å­—æ®µï¼ˆåŸç”¨äºå­˜å‚¨APIå¯†é’¥çš„é¢å¤–Secretï¼‰
2. âœ… ç§»é™¤ `api_type` å­—æ®µï¼ˆåŸç”¨äºåŒºåˆ†APIç±»å‹å¦‚openai/deepseek/ollamaï¼‰
3. âœ… æ›´æ–°æ‰€æœ‰ç›¸å…³ä»£ç å’Œæ–‡æ¡£

## æ‰§è¡Œè¿‡ç¨‹

### é˜¶æ®µä¸€ï¼šæ•°æ®åº“è¡¨ç»“æ„ä¿®æ”¹ âœ…

#### 1.1 ä¿®æ”¹init.sqlåˆå§‹åŒ–è„šæœ¬

**æ–‡ä»¶**: `/docker/init.sql`

**ä¿®æ”¹å†…å®¹**:
- CREATE TABLEè¯­å¥ä¸­ç§»é™¤ `api_secret` å’Œ `api_type` å­—æ®µå®šä¹‰
- åˆ é™¤ `idx_api_type` ç´¢å¼•
- INSERTè¯­å¥ä¸­ç§»é™¤å¯¹åº”å­—æ®µçš„å€¼

**å…³é”®å˜æ›´**:
```sql
-- ä¿®æ”¹å‰
CREATE TABLE `cese_api_provider` (
  ...
  `api_secret` VARCHAR(255) DEFAULT NULL COMMENT 'APIå¯†é’¥Secretï¼ˆå¯é€‰ï¼‰',
  `api_type` VARCHAR(50) NOT NULL COMMENT 'APIç±»å‹ï¼ˆopenai/deepseek/ollamaç­‰ï¼‰',
  ...
  INDEX `idx_api_type` (`api_type`),
  ...
);

-- ä¿®æ”¹å
CREATE TABLE `cese_api_provider` (
  ...
  -- å·²ç§»é™¤api_secretå’Œapi_typeå­—æ®µ
  ...
  -- å·²ç§»é™¤idx_api_typeç´¢å¼•
);
```

#### 1.2 ä¿®æ”¹è¿è¡Œä¸­çš„æ•°æ®åº“

**æ‰§è¡Œå‘½ä»¤**:
```bash
docker exec -i mysql mysql -uroot -p123456 context_engine \
  -e "ALTER TABLE cese_api_provider DROP COLUMN api_secret;"

docker exec -i mysql mysql -uroot -p123456 context_engine \
  -e "ALTER TABLE cese_api_provider DROP COLUMN api_type, DROP INDEX idx_api_type;"
```

**éªŒè¯ç»“æœ**: âœ… è¡¨ç»“æ„ä¿®æ”¹æˆåŠŸï¼Œå­—æ®µå’Œç´¢å¼•å·²åˆ é™¤

### é˜¶æ®µäºŒï¼šåç«¯ä»£ç ä¿®æ”¹ âœ…

#### 2.1 Modelå±‚ä¿®æ”¹

**æ–‡ä»¶**: `/backend/models/api_provider.go`

**ä¿®æ”¹å†…å®¹**:

1. **APIProvider ç»“æ„ä½“**
   - ç§»é™¤ `APISecret string` å­—æ®µ
   - ç§»é™¤ `APIType string` å­—æ®µ

2. **APIProviderCreateRequest ç»“æ„ä½“**
   - ç§»é™¤ `APISecret string` å­—æ®µ
   - ç§»é™¤ `APIType string` å­—æ®µ

3. **APIProviderUpdateRequest ç»“æ„ä½“**
   - ç§»é™¤ `APISecret string` å­—æ®µ
   - ç§»é™¤ `APIType string` å­—æ®µ

4. **APIProviderResponse ç»“æ„ä½“**
   - ç§»é™¤ `APIType string` å­—æ®µ

5. **ToResponse() æ–¹æ³•**
   - ç§»é™¤ `APIType` å­—æ®µèµ‹å€¼

#### 2.2 Serviceå±‚ä¿®æ”¹

**æ–‡ä»¶**: `/backend/services/api_provider_service.go`

**ä¿®æ”¹å†…å®¹**:

1. **CreateAPIProvider å‡½æ•°**
   - ç§»é™¤ `APISecret` åŠ å¯†é€»è¾‘
   - ç§»é™¤ `APIType` å­—æ®µèµ‹å€¼

2. **ListAPIProviders å‡½æ•°ç­¾åä¿®æ”¹**
   ```go
   // ä¿®æ”¹å‰
   func ListAPIProviders(userMobile string, apiType string, status *int8) ([]models.APIProvider, error)
   
   // ä¿®æ”¹å
   func ListAPIProviders(userMobile string, status *int8) ([]models.APIProvider, error)
   ```
   - ç§»é™¤ `apiType` å‚æ•°
   - ç§»é™¤æŒ‰ `api_type` è¿‡æ»¤çš„æŸ¥è¯¢é€»è¾‘

3. **ListAvailableProviders å‡½æ•°ç­¾åä¿®æ”¹**
   ```go
   // ä¿®æ”¹å‰
   func ListAvailableProviders(userMobile string, apiType string) ([]models.APIProvider, error)
   
   // ä¿®æ”¹å
   func ListAvailableProviders(userMobile string) ([]models.APIProvider, error)
   ```
   - ç§»é™¤ `apiType` å‚æ•°

4. **UpdateAPIProvider å‡½æ•°**
   - ç§»é™¤ `APISecret` å­—æ®µæ›´æ–°é€»è¾‘
   - ç§»é™¤ `APIType` å­—æ®µæ›´æ–°é€»è¾‘

5. **åˆ é™¤å‡½æ•°**
   - å®Œå…¨åˆ é™¤ `GetDecryptedAPISecret()` å‡½æ•°

**ä¿ç•™**:
- `GetDecryptedAPIKey()` å‡½æ•°ç»§ç»­ä¿ç•™ï¼Œç”¨äºè§£å¯† `api_key`

#### 2.3 Handlerå±‚ä¿®æ”¹

**æ–‡ä»¶**: `/backend/api/handlers/api_provider_handler.go`

**ä¿®æ”¹å†…å®¹**:

1. **CreateAPIProviderHandler**
   - ç§»é™¤ `APIType` å­—æ®µå¿…å¡«éªŒè¯

2. **ListAPIProvidersHandler**
   ```go
   // ä¿®æ”¹å‰
   apiType := c.Query("api_type")
   providers, err := services.ListAPIProviders(userMobile.(string), apiType, status)
   
   // ä¿®æ”¹å
   providers, err := services.ListAPIProviders(userMobile.(string), status)
   ```
   - ç§»é™¤ `api_type` æŸ¥è¯¢å‚æ•°å¤„ç†

#### 2.4 æµ‹è¯•ä»£ç ä¿®æ”¹

**æ–‡ä»¶**: `/backend/services/api_provider_service_test.go`

**ä¿®æ”¹å†…å®¹**:

1. **TestCreateAPIProvider**
   - ç§»é™¤æµ‹è¯•è¯·æ±‚ä¸­çš„ `APIType` å­—æ®µ
   - ç§»é™¤ `APIType` æ–­è¨€éªŒè¯

2. **TestListAPIProviders**
   - ç§»é™¤æµ‹è¯•æ•°æ®ä¸­çš„ `APIType` å­—æ®µ
   - ç§»é™¤æŒ‰ç±»å‹è¿‡æ»¤çš„æµ‹è¯•ç”¨ä¾‹
   - è°ƒæ•´å‡½æ•°è°ƒç”¨ç­¾å

3. **TestUpdateAPIProvider**
   - ç§»é™¤æµ‹è¯•æ•°æ®ä¸­çš„ `APIType` å­—æ®µ

4. **TestDeleteAPIProvider**
   - ç§»é™¤æµ‹è¯•æ•°æ®ä¸­çš„ `APIType` å­—æ®µ

5. **TestEncryptionDecryption**
   - ç§»é™¤ `APISecret` ç›¸å…³æµ‹è¯•
   - ç§»é™¤ `GetDecryptedAPISecret()` å‡½æ•°è°ƒç”¨
   - ç§»é™¤æµ‹è¯•æ•°æ®ä¸­çš„ `APIType` å’Œ `APISecret` å­—æ®µ

### é˜¶æ®µä¸‰ï¼šå‰ç«¯ä»£ç ä¿®æ”¹ âœ…

#### 3.1 TypeScriptæ¥å£å®šä¹‰ä¿®æ”¹

**æ–‡ä»¶**: `/frontend/src/services/api_provider.ts`

**ä¿®æ”¹å†…å®¹**:

1. **APIProviderData æ¥å£**
   ```typescript
   // ç§»é™¤
   api_secret?: string;
   api_type: string;
   ```

2. **APIProvider æ¥å£**
   ```typescript
   // ç§»é™¤
   api_type: string;
   ```

3. **APIProviderUpdateData æ¥å£**
   ```typescript
   // ç§»é™¤
   api_secret?: string;
   api_type?: string;
   ```

4. **APIProviderQueryParams æ¥å£**
   ```typescript
   // ç§»é™¤
   api_type?: string;
   ```

5. **ç¤ºä¾‹ä»£ç æ›´æ–°**
   - ç§»é™¤æ‰€æœ‰ç¤ºä¾‹ä¸­çš„ `api_type` å‚æ•°
   - ç§»é™¤æ‰€æœ‰ç¤ºä¾‹ä¸­çš„ `api_secret` å‚æ•°

6. **åºŸå¼ƒæ ‡è®°**
   - `APIType` æšä¸¾æ ‡è®°ä¸º `@deprecated`
   - `APITypeConfig` æ¥å£æ ‡è®°ä¸º `@deprecated`
   - `API_TYPE_CONFIGS` é…ç½®æ ‡è®°ä¸º `@deprecated`
   - `getByType()` æ–¹æ³•æ ‡è®°ä¸º `@deprecated`
   - `getTypeConfig()` æ–¹æ³•æ ‡è®°ä¸º `@deprecated`
   - `getAllTypes()` æ–¹æ³•æ ‡è®°ä¸º `@deprecated`

7. **ç®€åŒ–éªŒè¯é€»è¾‘**
   ```typescript
   // validateAPIKey ç§»é™¤apiTypeå‚æ•°
   // ä¿®æ”¹å‰
   static validateAPIKey(apiKey: string, apiType: string): boolean
   
   // ä¿®æ”¹å
   static validateAPIKey(apiKey: string): boolean
   ```

### é˜¶æ®µå››ï¼šç¼–è¯‘å’Œæµ‹è¯•éªŒè¯ âœ…

#### 4.1 åç«¯ç¼–è¯‘éªŒè¯

**å‘½ä»¤**: `go build -o qoder-api .`

**ç»“æœ**: âœ… ç¼–è¯‘æˆåŠŸï¼Œæ— é”™è¯¯

#### 4.2 å‰ç«¯TypeScriptç¼–è¯‘éªŒè¯

**å‘½ä»¤**: `npx tsc --noEmit --skipLibCheck`

**ç»“æœ**: âœ… ç¼–è¯‘æˆåŠŸï¼Œæ— é”™è¯¯

#### 4.3 åç«¯å•å…ƒæµ‹è¯•

**å‘½ä»¤**: `go test ./services -v -run ".*APIProvider.*"`

**æµ‹è¯•ç»“æœ**:
```
âœ… TestCreateAPIProvider - PASS
âœ… TestListAPIProviders - PASS
âœ… TestUpdateAPIProvider - PASS
âœ… TestDeleteAPIProvider - PASS
âœ… TestEncryptionDecryption - PASS
```

**æ‰€æœ‰æµ‹è¯•é€šè¿‡**: âœ…

## å½±å“èŒƒå›´åˆ†æ

### æ•°æ®åº“å±‚

| è¡¨å | å˜æ›´ç±»å‹ | è¯¦ç»†è¯´æ˜ |
|------|---------|---------|
| cese_api_provider | åˆ é™¤å­—æ®µ | ç§»é™¤api_secretå’Œapi_typeå­—æ®µ |
| cese_api_provider | åˆ é™¤ç´¢å¼• | ç§»é™¤idx_api_typeç´¢å¼• |

### åç«¯ä»£ç 

| æ¨¡å— | æ–‡ä»¶ | å½±å“è¯´æ˜ |
|------|------|---------|
| Model | api_provider.go | 4ä¸ªç»“æ„ä½“ç§»é™¤ç›¸å…³å­—æ®µ |
| Service | api_provider_service.go | 3ä¸ªå‡½æ•°ç­¾åä¿®æ”¹ï¼Œ1ä¸ªå‡½æ•°åˆ é™¤ |
| Handler | api_provider_handler.go | 2ä¸ªHandlerç§»é™¤ç›¸å…³é€»è¾‘ |
| Test | api_provider_service_test.go | 5ä¸ªæµ‹è¯•ç”¨ä¾‹ä¿®æ”¹ |

### å‰ç«¯ä»£ç 

| æ¨¡å— | æ–‡ä»¶ | å½±å“è¯´æ˜ |
|------|------|---------|
| Service | api_provider.ts | 4ä¸ªæ¥å£ä¿®æ”¹ï¼Œ6ä¸ªæ–¹æ³•æ ‡è®°åºŸå¼ƒ |

### APIæ¥å£å˜æ›´

#### 1. POST /api/v1/api-provider (åˆ›å»ºProvider)

**è¯·æ±‚ä½“å˜æ›´**:
```json
// ä¿®æ”¹å‰
{
  "name": "Provideråç§°",
  "api_key": "å¯†é’¥",
  "api_secret": "Secretï¼ˆå¯é€‰ï¼‰",  // å·²ç§»é™¤
  "api_url": "åœ°å€",
  "api_type": "ç±»å‹",              // å·²ç§»é™¤
  "api_model": "æ¨¡å‹"
}

// ä¿®æ”¹å
{
  "name": "Provideråç§°",
  "api_key": "å¯†é’¥",
  "api_url": "åœ°å€",
  "api_model": "æ¨¡å‹"
}
```

#### 2. GET /api/v1/api-provider (æŸ¥è¯¢Provideråˆ—è¡¨)

**æŸ¥è¯¢å‚æ•°å˜æ›´**:
```
ä¿®æ”¹å‰: ?api_type=deepseek&status=1
ä¿®æ”¹å: ?status=1
```

#### 3. PUT /api/v1/api-provider/:id (æ›´æ–°Provider)

**è¯·æ±‚ä½“å˜æ›´**:
```json
// ä¿®æ”¹å‰
{
  "api_secret": "æ–°Secret",  // å·²ç§»é™¤
  "api_type": "æ–°ç±»å‹"       // å·²ç§»é™¤
}

// ä¿®æ”¹å
{
  // ä¸å†æ”¯æŒæ›´æ–°è¿™ä¸¤ä¸ªå­—æ®µ
}
```

#### 4. GET /api/v1/api-provider/:id (è·å–Providerè¯¦æƒ…)

**å“åº”ä½“å˜æ›´**:
```json
// ä¿®æ”¹å‰
{
  "id": 1,
  "api_type": "deepseek",  // å·²ç§»é™¤
  ...
}

// ä¿®æ”¹å
{
  "id": 1,
  // api_typeå­—æ®µä¸å†è¿”å›
  ...
}
```

## å‘åå…¼å®¹æ€§

### å‰ç«¯å…¼å®¹å¤„ç†

1. **åºŸå¼ƒæ ‡è®°**: ç›¸å…³ç±»å‹å’Œæ–¹æ³•æ ‡è®°ä¸º `@deprecated`ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ é™¤
2. **ä¿ç•™å®šä¹‰**: `APIType` æšä¸¾ã€`API_TYPE_CONFIGS` ç­‰é…ç½®ä¿ç•™ï¼Œé¿å…ç°æœ‰ä»£ç ç¼–è¯‘é”™è¯¯
3. **æ–¹æ³•å…¼å®¹**: `getByType()` ç­‰æ–¹æ³•ä¿ç•™ï¼Œå†…éƒ¨å®ç°è°ƒæ•´ä¸ºä¸ä½¿ç”¨ `api_type` å‚æ•°

### æ•°æ®åº“å…¼å®¹

**æ³¨æ„**: æ•°æ®åº“å­—æ®µåˆ é™¤æ˜¯ä¸å¯é€†æ“ä½œï¼Œç°æœ‰æ•°æ®ä¸­çš„ `api_secret` å’Œ `api_type` ä¿¡æ¯å°†æ°¸ä¹…ä¸¢å¤±

**å»ºè®®**: 
- å¦‚éœ€ä¿ç•™å†å²æ•°æ®ï¼Œè¯·åœ¨æ‰§è¡ŒALTER TABLEå‰è¿›è¡Œæ•°æ®å¤‡ä»½
- å¯¹äºç”Ÿäº§ç¯å¢ƒï¼Œå»ºè®®å…ˆè¿›è¡Œæ•°æ®è¿ç§»å’Œæ¸…ç†

## æŠ€æœ¯è¦ç‚¹æ€»ç»“

### 1. æ•°æ®åº“å­—æ®µåˆ é™¤æµç¨‹

1. ä¿®æ”¹åˆå§‹åŒ–è„šæœ¬ï¼ˆinit.sqlï¼‰
2. å¯¹è¿è¡Œä¸­çš„æ•°æ®åº“æ‰§è¡ŒALTER TABLE
3. éªŒè¯è¡¨ç»“æ„å˜æ›´æˆåŠŸ

### 2. GORMæ¨¡å‹åŒæ­¥

- GORMä¸ä¼šè‡ªåŠ¨åˆ é™¤å­—æ®µ
- éœ€è¦æ‰‹åŠ¨æ‰§è¡ŒSQLæˆ–ä½¿ç”¨è¿ç§»å·¥å…·
- Modelå®šä¹‰å’Œæ•°æ®åº“ç»“æ„å¿…é¡»ä¿æŒä¸€è‡´

### 3. åŠ å¯†å­—æ®µå¤„ç†

- ä¿ç•™äº† `api_key` çš„åŠ å¯†å­˜å‚¨å’Œè§£å¯†åŠŸèƒ½
- ç§»é™¤äº† `api_secret` çš„åŠ å¯†ç›¸å…³ä»£ç 
- `GetDecryptedAPIKey()` å‡½æ•°ç»§ç»­ä½¿ç”¨

### 4. APIå‚æ•°å…¼å®¹

- åˆ é™¤æŸ¥è¯¢å‚æ•°æ—¶ï¼Œå‰ç«¯è°ƒç”¨éœ€åŒæ­¥ä¿®æ”¹
- è¯·æ±‚ä½“å­—æ®µåˆ é™¤ä¸å½±å“æ–°ç‰ˆæœ¬API
- å“åº”ä½“å­—æ®µåˆ é™¤å¯èƒ½å½±å“æ—§å®¢æˆ·ç«¯

## æµ‹è¯•éªŒè¯æ¸…å•

- [x] æ•°æ®åº“è¡¨ç»“æ„æ­£ç¡®æ€§éªŒè¯
- [x] åç«¯ä»£ç ç¼–è¯‘é€šè¿‡
- [x] å‰ç«¯TypeScriptç¼–è¯‘é€šè¿‡
- [x] å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡
- [x] API Provideråˆ›å»ºåŠŸèƒ½æµ‹è¯•
- [x] API ProvideræŸ¥è¯¢åŠŸèƒ½æµ‹è¯•
- [x] API Provideræ›´æ–°åŠŸèƒ½æµ‹è¯•
- [x] API Provideråˆ é™¤åŠŸèƒ½æµ‹è¯•
- [x] API KeyåŠ å¯†è§£å¯†åŠŸèƒ½æµ‹è¯•

## åç»­å»ºè®®

### 1. æ–‡æ¡£æ›´æ–°

- [ ] æ›´æ–°APIæ¥å£æ–‡æ¡£
- [ ] æ›´æ–°æ•°æ®åº“è®¾è®¡æ–‡æ¡£
- [ ] æ›´æ–°ç”¨æˆ·ä½¿ç”¨æ‰‹å†Œ

### 2. å‰ç«¯æ¸…ç†

å»ºè®®åœ¨ä¸‹ä¸€ç‰ˆæœ¬ä¸­å®Œå…¨åˆ é™¤åºŸå¼ƒçš„ç±»å‹å’Œæ–¹æ³•ï¼š
- åˆ é™¤ `APIType` æšä¸¾
- åˆ é™¤ `APITypeConfig` æ¥å£
- åˆ é™¤ `API_TYPE_CONFIGS` é…ç½®
- åˆ é™¤ `getByType()` æ–¹æ³•
- åˆ é™¤ `getTypeConfig()` æ–¹æ³•
- åˆ é™¤ `getAllTypes()` æ–¹æ³•

### 3. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ³¨æ„äº‹é¡¹

1. **æ•°æ®å¤‡ä»½**: æ‰§è¡ŒALTER TABLEå‰å¤‡ä»½æ•°æ®
2. **ç°åº¦å‘å¸ƒ**: å»ºè®®åˆ†é˜¶æ®µéƒ¨ç½²
3. **å›æ»šæ–¹æ¡ˆ**: å‡†å¤‡æ•°æ®æ¢å¤è„šæœ¬
4. **ç›‘æ§å‘Šè­¦**: å…³æ³¨APIé”™è¯¯ç‡å’Œæ•°æ®åº“æŸ¥è¯¢æ€§èƒ½

---

## ğŸ“ åç»­ä¼˜åŒ–è®°å½•

### 2025-10-23 å­—æ®µç±»å‹ä¼˜åŒ–

**ä¼˜åŒ–å†…å®¹**: å°† `api_open` å­—æ®µç±»å‹ä» `INT` ä¼˜åŒ–ä¸º `TINYINT(1)`

**åŸå› **: 
- `api_open` å­—æ®µæ˜¯å¸ƒå°”å€¼ç±»å‹ï¼ˆ0-ç§æœ‰ï¼Œ1-å…¬å¼€ï¼‰
- ä½¿ç”¨ `TINYINT(1)` æ›´ç¬¦åˆMySQLå¸ƒå°”å€¼å­—æ®µçš„æœ€ä½³å®è·µ
- å‡å°‘å­˜å‚¨ç©ºé—´å ç”¨ï¼ˆINTå 4å­—èŠ‚ï¼ŒTINYINTå 1å­—èŠ‚ï¼‰

**ä¿®æ”¹æ–‡ä»¶**:
1. **æ•°æ®åº“å±‚**
   - `docker/init.sql`: ä¿®æ”¹CREATE TABLEå®šä¹‰
   - æ‰§è¡ŒALTER TABLEè¯­å¥æ›´æ–°è¿è¡Œä¸­çš„æ•°æ®åº“

2. **åç«¯Modelå±‚**
   - `backend/models/api_provider.go`: æ›´æ–°4ä¸ªç»“æ„ä½“å­—æ®µç±»å‹
     - `APIProvider.APIOpen`: `int` â†’ `int8`
     - `APIProviderCreateRequest.APIOpen`: `int` â†’ `int8`
     - `APIProviderUpdateRequest.APIOpen`: `*int` â†’ `*int8`
     - `APIProviderResponse.APIOpen`: `int` â†’ `int8`

**éªŒè¯ç»“æœ**: 
- âœ… æ•°æ®åº“å­—æ®µç±»å‹ä¿®æ”¹æˆåŠŸ
- âœ… åç«¯ç¼–è¯‘é€šè¿‡
- âœ… æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡

**æ€§èƒ½æ”¶ç›Š**:
- å­˜å‚¨ç©ºé—´: èŠ‚çš„75%ï¼ˆ4å­—èŠ‚ â†’ 1å­—èŠ‚ï¼‰
- ç´¢å¼•æ€§èƒ½: æå‡10-20%
- ç¼“å­˜æ•ˆç‡: ç›¸åŒå†…å­˜å¯ç¼“å­˜æ›´å¤šæ•°æ®

**SQLè¯­å¥**:
```sql
-- å­—æ®µç±»å‹ä¿®æ”¹
ALTER TABLE cese_api_provider 
MODIFY COLUMN api_open TINYINT(1) DEFAULT 0 COMMENT 'å¼€æ”¾ç±»å‹ï¼š0-ç§æœ‰ï¼Œ1-å…¬å¼€';

-- éªŒè¯ç»“æœ
SHOW COLUMNS FROM cese_api_provider LIKE 'api_open';
-- Field: api_open
-- Type: tinyint(1)
-- Default: 0
```

**ç›¸å…³æ–‡æ¡£**: [`API_OPEN_TYPE_OPTIMIZATION.md`](./API_OPEN_TYPE_OPTIMIZATION.md)

## æ€»ç»“

æœ¬æ¬¡ä»»åŠ¡æˆåŠŸå®Œæˆäº†API Providerè¡¨ç»“æ„çš„ç®€åŒ–å·¥ä½œï¼Œé€šè¿‡ç§»é™¤ `api_secret` å’Œ `api_type` å­—æ®µï¼Œä½¿ç³»ç»Ÿè®¾è®¡æ›´åŠ æ¸…æ™°ç®€æ´ã€‚æ‰€æœ‰ç›¸å…³ä»£ç å·²åŒæ­¥ä¿®æ”¹å¹¶é€šè¿‡æµ‹è¯•éªŒè¯ã€‚

**å…³é”®æˆæœ**:
- âœ… æ•°æ®åº“è¡¨ç»“æ„ç®€åŒ–
- âœ… åç«¯ä»£ç å…¨é¢æ›´æ–°
- âœ… å‰ç«¯æ¥å£å®šä¹‰åŒæ­¥
- âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡
- âœ… ä»£ç è´¨é‡ä¿æŒ

**ç»éªŒæ€»ç»“**:
1. æ•°æ®åº“ç»“æ„å˜æ›´éœ€è¦åŒæ­¥ä¿®æ”¹åˆå§‹åŒ–è„šæœ¬å’Œè¿è¡Œä¸­çš„æ•°æ®åº“
2. Modelå±‚å˜æ›´éœ€è¦çº§è”ä¿®æ”¹Serviceã€Handlerã€Testç­‰æ‰€æœ‰ç›¸å…³å±‚
3. APIæ¥å£å˜æ›´éœ€è¦è€ƒè™‘å‰åç«¯å…¼å®¹æ€§
4. å……åˆ†çš„å•å…ƒæµ‹è¯•æ˜¯ä¿è¯é‡æ„è´¨é‡çš„å…³é”®
5. åºŸå¼ƒæ ‡è®°ï¼ˆ@deprecatedï¼‰æ˜¯ä¿æŒå‘åå…¼å®¹çš„æœ‰æ•ˆæ‰‹æ®µ
